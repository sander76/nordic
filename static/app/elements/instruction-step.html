<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html" />
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">

<link rel="import" href="../bower_components/iron-a11y-keys/iron-a11y-keys.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="nav-button.html">
<link rel="import" href="ui-cell.html" />
<link rel="import" href="../bower_components/marked-element/marked-element.html">
<!-- <link rel="import" href="pv-remote.html" /> -->
<!-- <link rel="import" href="../styles/shared-styles.html" /> -->

<dom-module id="instruction-step">
    <style include="shared-styles"></style>
    <style>
        iron-icon.ok {
            color: var(--icon-ok-color) !important;
        }
        
        iron-icon.cross {
            color: var(--icon-cross-color) !important;
        }
        
        :host {
            height: 100%;
        }
        
        #col1 {
            min-width: 4em;
        }
        
        .instr_img {
            max-height: 150px;
            max-width: 300px;
            width: auto;
            height: auto;
        }
        
        .rule {
            margin: 5px;
        }
        
        h1 {
            font-size: 22px;
            margin: 16px 0;
            color: #212121;
        }
        
        .markdown-html {
            font-size: 1.4em;
        }
        
        footer {
            position: fixed;
            bottom: 0;
        }
        
        #container {
            min-height: 100vh;
        }
        
    </style>
    <style include="iron-flex iron-flex-alignment"></style>
    <template>
        <div class="vertical layout flex" id="container">
            <div style="margin:10px;" class="flex vertical layout">
                <marked-element markdown="[[data.title.content]]">
                    <div class="markdown-html"></div>
                </marked-element>
                <div class="flex vertical layout">
                    <template is="dom-repeat" items="[[data.instructions]]">
                        <div class="horizontal layout start rule">
                            <ui-cell id="col1" active="[[active]]" data="[[item.col1]]"></ui-cell>
                            <ui-cell id="col2" active="[[active]]" data="[[item.col2]]"></ui-cell>
                            <ui-cell id="col3" active="[[active]]" data="[[item.col3]]"></ui-cell>
                            <ui-cell id="col4" active="[[active]]" data="[[item.col4]]"></ui-cell>
                        </div>
                        <!-- <ui-row active="[[active]]" data="[[item]]"></ui-row> -->
                    </template>

                </div>
                <div class="horizontal layout justified">
                    <div>
                        <nav-button hidden="[[!data.previous.active]]" id="previousbutton" active="[[active]]" data="[[data.previous]]">[[data.previous.caption]]</nav-button>
                    </div>
                    <div>
                        <nav-button hidden="[[!data.next.active]]" id="nextbutton" active="[[active]]" data="[[data.next]]">[[data.next.caption]]</nav-button>
                    </div>
                </div>
            </div>
        </div>
        <!--<footer>
                
            </footer>-->
    </template>
    <script>
        Polymer({
            is: 'instruction-step',
            properties: {
                data: {
                    type: Object,
                },
                curitem: {
                    type: Number
                },
                selected: {
                    type: Number,
                    observer: '_selectedChanged'
                },
                active: {
                    type: Boolean
                }
                // selectedinstruction: {
                //     type: Number,
                //     observer: '_selectedChanged'
                // },
                // instruction: {
                //     type: Number
                // },


                // ,
                // target: {
                //     type: Object,
                //     value: function() {
                //         return this.$.modal;
                //     }
                // }
            },
            // listeners: {
            //     'openmodal': "_openModal"
            // },

            ready: function() {
                // if (this.data.next.keys === undefined) {
                //     this.set("data.next.keys", "pagedown 3");
                // }
                // if (this.data.previous.keys === undefined) {
                //     this.set("data.previous.keys", "end 1");
                // }

            },
            getType: function(item, container) {
                if (item.type == "text") {
                    var el = document.createElement('p');
                    el.innerText = item.content;
                    return el;

                }
            },
            isType: function(instruction, _type) {
                var tr = instruction.type === _type;
                return tr;
            },
            _next: function(e) {
                this.fire('nextpage');
            },
            _prev: function(e) {
                this.fire('previouspage');
            },


            // _openModal: function(e) {
            //   this.fire("opendialog");
            //     // console.log("open modal");
            //     // this.$.modalconfirm.target = document.body;
            //     // this.$.modaldismiss.target = document.body;
            //     // //this.active = false;
            //     // this.set("active", false);
            //     // this.$.modal.open();
            // },
            _selectedChanged: function() {
                var active = this.curitem === this.selected;
                this.set("active", active);
            },
            deactivate: function() {
                this.set("active", false);
            },
            activate: function() {
                this.set("active", true);
            }


        });
    </script>
</dom-module>