<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html" />
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">

<link rel="import" href="../bower_components/iron-a11y-keys/iron-a11y-keys.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">

<link rel="import" href="nav-button.html">
<link rel="import" href="ui-cell.html" />
<link rel="import" href="../bower_components/marked-element/marked-element.html">
<!-- <link rel="import" href="pv-remote.html" /> -->
<!-- <link rel="import" href="../styles/shared-styles.html" /> -->

<dom-module id="instruction-step">
    <style include="shared-styles"></style>
    <style>
        iron-icon.ok {
            color: var(--icon-ok-color) !important;
        }

        iron-icon.cross {
            color: var(--icon-cross-color) !important;
        }

         :host {
            height: 100%;
        }

        #col1 {
            min-width: 4em;
        }



        .rule {
            margin: 5px;
        }

        h1 {
            font-size: 22px;
            margin: 16px 0;
            color: #212121;
        }

        .markdown-html {
            font-size: 1.4em;
        }

        footer {
            position: fixed;
            bottom: 0;
        }

        #container {
            min-height: 100vh;
        }
    </style>
    <style include="iron-flex iron-flex-alignment"></style>
    <template>
        <div class="vertical layout flex" id="container">
            <div style="margin:10px;" class="flex vertical layout">
                <marked-element markdown="[[data.title.content]]">
                    <div class="markdown-html"></div>
                </marked-element>
                <div class="flex vertical layout">
                    <template is="dom-repeat" items="[[data.instructions]]">
                        <div class="horizontal layout start rule">
                            <!--<ui-cell id="col1" idx="[[index]]" data="[[get_column(item,'col1')]]"></ui-cell>
                            <ui-cell id="col2" data="[[get_column(item,'col2')]]" idx="[[index]]"></ui-cell>
                            <ui-cell id="col3" data="[[get_column(item,'col3')]]" idx="[[index]]"></ui-cell>
                            <ui-cell id="col4" data="[[get_column(item,'col4')]]" idx="[[index]]"></ui-cell>-->

                            <ui-cell id="col1" idx="[[index]]" data="[[item.col1]]"></ui-cell>
                            <ui-cell id="col2" data="[[item.col2]]" idx="[[index]]"></ui-cell>
                            <ui-cell id="col3" data="[[item.col3]]" idx="[[index]]"></ui-cell>
                            <ui-cell id="col4" data="[[item.col4]]" idx="[[index]]"></ui-cell>
                        </div>
                    </template>

                </div>
                <div class="horizontal layout justified">
                    <div>
                        <paper-button noink class="instruction" raised on-tap="_prev" hidden="[[previous_hidden]]">
                            [[data.previous.caption]]
                        </paper-button>
                        <!--<nav-button hidden="[[!data.previous.active]]" id="previousbutton" active="[[active]]" data="[[data.previous]]"></nav-button>-->
                    </div>
                    <div>
                        <paper-button noink class="instruction" raised on-tap="_next">
                            [[data.next.caption]]
                        </paper-button>
                        <!--<nav-button hidden="[[!data.next.active]]" id="nextbutton" active="[[active]]" data="[[data.next]]">[[data.next.caption]]</nav-button>-->
                    </div>
                </div>
            </div>
        </div>
        <!--<footer>
                
            </footer>-->
    </template>
    <script>
        Polymer({
            is: 'instruction-step',
            properties: {
                data: {
                    type: Object,
                },
                // curitem: {
                //     type: Number
                // },

                active: {
                    type: Boolean
                }
            },
            // listeners: {
            //     'openmodal': "_openModal"
            // },

            ready: function () {
                // if (this.curitem==0){
                //     this.previous_hidden=true;
                // }
                // if (this.data.next.keys === undefined) {
                //     this.set("data.next.keys", "pagedown 3");
                // }
                // if (this.data.previous.keys === undefined) {
                //     this.set("data.previous.keys", "end 1");
                // }

            },
            getType: function (item, container) {
                if (item.type == "text") {
                    var el = document.createElement('p');
                    el.innerText = item.content;
                    return el;

                }
            },
            get_column: function (item, column) {
                var col = item[column];
                if (col) {
                    return col;
                } else {
                    return {};
                }
            },
            _next: function (e) {
                this.fire('gotopage', 1);
                console.log("Next button clicked.");
            },
            _prev: function (e) {
                this.fire('gotopage', -1);
                console.log("Previous button clicked.");
            },

            // _selectedChanged: function () {
            //     var active = this.curitem === this.selected;
            //     if (active) {
            //         document.reset_keys();
            //     }
            //     this.set("active", active);
            // },
            deactivate: function () {
                this.set("active", false);
            },
            activate: function () {
                document.reset_keys();
                this.set("active", true);
            }


        });
    </script>
</dom-module>